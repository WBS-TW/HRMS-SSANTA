<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Molecular networks | Handbook of comprehensive suspect and nontarget workflows in environmental analysis using GC and LC-HRMS</title>
  <meta name="description" content="SSANTA." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Molecular networks | Handbook of comprehensive suspect and nontarget workflows in environmental analysis using GC and LC-HRMS" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://www.oru.se/personal/thanh_wang/images/ORU.png" />
  <meta property="og:description" content="SSANTA." />
  <meta name="github-repo" content="WBS-TW/WBS-TW.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Molecular networks | Handbook of comprehensive suspect and nontarget workflows in environmental analysis using GC and LC-HRMS" />
  
  <meta name="twitter:description" content="SSANTA." />
  <meta name="twitter:image" content="https://www.oru.se/personal/thanh_wang/images/ORU.png" />

<meta name="author" content="Thanh Wang,   MTM Research Centre, Örebro University" />


<meta name="date" content="2022-04-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="RetentionTime.html"/>
<link rel="next" href="Library.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.9/grViz.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.22/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SSA/NTA</a></li>

<li class="divider"></li>
<li><a href="index.html#preface">Preface<span></span></a></li>
<li class="chapter" data-level="1" data-path="Intro.html"><a href="Intro.html"><i class="fa fa-check"></i><b>1</b> <strong>Introduction and concepts</strong><span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="Intro.html"><a href="Intro.html#terminologies"><i class="fa fa-check"></i><b>1.1</b> Terminologies<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ExpDesign.html"><a href="ExpDesign.html"><i class="fa fa-check"></i><b>2</b> <strong>Experimental design</strong><span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="ExpDesign.html"><a href="ExpDesign.html#hypothesis"><i class="fa fa-check"></i><b>2.1</b> Hypothesis<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="ExpDesign.html"><a href="ExpDesign.html#experimental-design"><i class="fa fa-check"></i><b>2.2</b> Experimental design<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="ExpDesign.html"><a href="ExpDesign.html#qaqc-measures"><i class="fa fa-check"></i><b>2.3</b> QA/QC measures<span></span></a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="ExpDesign.html"><a href="ExpDesign.html#recovery-extraction-efficieny"><i class="fa fa-check"></i><b>2.3.1</b> Recovery (Extraction efficieny)<span></span></a></li>
<li class="chapter" data-level="2.3.2" data-path="ExpDesign.html"><a href="ExpDesign.html#matrix-effects"><i class="fa fa-check"></i><b>2.3.2</b> Matrix effects<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="ExpDesign.html"><a href="ExpDesign.html#data-directory-structure"><i class="fa fa-check"></i><b>2.4</b> Data directory structure<span></span></a></li>
<li class="chapter" data-level="2.5" data-path="ExpDesign.html"><a href="ExpDesign.html#sampling-design-and-collection"><i class="fa fa-check"></i><b>2.5</b> Sampling design and collection<span></span></a></li>
<li class="chapter" data-level="2.6" data-path="ExpDesign.html"><a href="ExpDesign.html#collection-of-metadata"><i class="fa fa-check"></i><b>2.6</b> Collection of metadata<span></span></a></li>
<li class="chapter" data-level="2.7" data-path="ExpDesign.html"><a href="ExpDesign.html#chemical-analysis"><i class="fa fa-check"></i><b>2.7</b> Chemical analysis<span></span></a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="ExpDesign.html"><a href="ExpDesign.html#data-recording-modes"><i class="fa fa-check"></i><b>2.7.1</b> Data recording modes<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="ExpDesign.html"><a href="ExpDesign.html#data-analysis"><i class="fa fa-check"></i><b>2.8</b> Data analysis<span></span></a></li>
<li class="chapter" data-level="2.9" data-path="ExpDesign.html"><a href="ExpDesign.html#workflow-examples"><i class="fa fa-check"></i><b>2.9</b> Workflow examples<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="SamplePretreatment.html"><a href="SamplePretreatment.html"><i class="fa fa-check"></i><b>3</b> <strong>Sample pretreatment for nontarget and suspect screening</strong><span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="SamplePretreatment.html"><a href="SamplePretreatment.html#accelerated-solvent-extraction-ase"><i class="fa fa-check"></i><b>3.1</b> Accelerated solvent extraction (ASE)<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="SamplePretreatment.html"><a href="SamplePretreatment.html#ultrasonic-extraction"><i class="fa fa-check"></i><b>3.2</b> Ultrasonic extraction<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="MSPreprocess.html"><a href="MSPreprocess.html"><i class="fa fa-check"></i><b>4</b> <strong>Pre-processing HRMS data</strong><span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="MSPreprocess.html"><a href="MSPreprocess.html#raw-data-conversion"><i class="fa fa-check"></i><b>4.1</b> Raw data conversion<span></span></a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="MSPreprocess.html"><a href="MSPreprocess.html#msconvert"><i class="fa fa-check"></i><b>4.1.1</b> MSConvert<span></span></a></li>
<li class="chapter" data-level="4.1.2" data-path="MSPreprocess.html"><a href="MSPreprocess.html#waters-mse"><i class="fa fa-check"></i><b>4.1.2</b> Waters MSe<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="MSPreprocess.html"><a href="MSPreprocess.html#peak-picking"><i class="fa fa-check"></i><b>4.2</b> Peak picking<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="MSPreprocess.html"><a href="MSPreprocess.html#open-tools-for-preprocessing"><i class="fa fa-check"></i><b>4.3</b> Open tools for preprocessing<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="MSPreprocess.html"><a href="MSPreprocess.html#openms-and-toppview"><i class="fa fa-check"></i><b>4.4</b> OpenMS and Toppview<span></span></a></li>
<li class="chapter" data-level="4.5" data-path="MSPreprocess.html"><a href="MSPreprocess.html#msnbase-and-xcms"><i class="fa fa-check"></i><b>4.5</b> MsnBase and XCMS<span></span></a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="MSPreprocess.html"><a href="MSPreprocess.html#xcms"><i class="fa fa-check"></i><b>4.5.1</b> XCMS<span></span></a></li>
<li class="chapter" data-level="4.5.2" data-path="MSPreprocess.html"><a href="MSPreprocess.html#camera"><i class="fa fa-check"></i><b>4.5.2</b> CAMERA<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="MSPreprocess.html"><a href="MSPreprocess.html#patroon"><i class="fa fa-check"></i><b>4.6</b> PatRoon<span></span></a></li>
<li class="chapter" data-level="4.7" data-path="MSPreprocess.html"><a href="MSPreprocess.html#ms-dial"><i class="fa fa-check"></i><b>4.7</b> MS-DIAL<span></span></a></li>
<li class="chapter" data-level="4.8" data-path="MSPreprocess.html"><a href="MSPreprocess.html#output-formats"><i class="fa fa-check"></i><b>4.8</b> Output formats<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="suspectScreening.html"><a href="suspectScreening.html"><i class="fa fa-check"></i><b>5</b> <strong>Suspect screening</strong><span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="suspectScreening.html"><a href="suspectScreening.html#lib2nist"><i class="fa fa-check"></i><b>5.1</b> LIB2NIST<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="suspectScreening.html"><a href="suspectScreening.html#listing-suspects"><i class="fa fa-check"></i><b>5.2</b> Listing suspects<span></span></a></li>
<li class="chapter" data-level="5.3" data-path="suspectScreening.html"><a href="suspectScreening.html#suspect-scoring"><i class="fa fa-check"></i><b>5.3</b> Suspect scoring<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="MassDefect.html"><a href="MassDefect.html"><i class="fa fa-check"></i><b>6</b> <strong>Mass defect plots</strong><span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="MassDefect.html"><a href="MassDefect.html#mdplotr"><i class="fa fa-check"></i><b>6.1</b> MDPlotR<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="MassDefect.html"><a href="MassDefect.html#findhalo"><i class="fa fa-check"></i><b>6.2</b> findhalo<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="RetentionTime.html"><a href="RetentionTime.html"><i class="fa fa-check"></i><b>7</b> <strong>Retention time index and prediction</strong><span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="RetentionTime.html"><a href="RetentionTime.html#lc"><i class="fa fa-check"></i><b>7.1</b> LC<span></span></a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="RetentionTime.html"><a href="RetentionTime.html#retip---retention-time-prediction-for-metabolomics"><i class="fa fa-check"></i><b>7.1.1</b> Retip - Retention Time prediction for Metabolomics<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="MolecularNetworks.html"><a href="MolecularNetworks.html"><i class="fa fa-check"></i><b>8</b> <strong>Molecular networks</strong><span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="MolecularNetworks.html"><a href="MolecularNetworks.html#metgem"><i class="fa fa-check"></i><b>8.1</b> MetGem<span></span></a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="MolecularNetworks.html"><a href="MolecularNetworks.html#metgem-parameters"><i class="fa fa-check"></i><b>8.1.1</b> Metgem parameters<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="MolecularNetworks.html"><a href="MolecularNetworks.html#gnps"><i class="fa fa-check"></i><b>8.2</b> GNPS<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Library.html"><a href="Library.html"><i class="fa fa-check"></i><b>9</b> <strong>Spectral libraries</strong><span></span></a>
<ul>
<li class="chapter" data-level="9.1" data-path="Library.html"><a href="Library.html#in-silico-fragmentation"><i class="fa fa-check"></i><b>9.1</b> IN SILICO FRAGMENTATION<span></span></a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="Library.html"><a href="Library.html#metfrag"><i class="fa fa-check"></i><b>9.1.1</b> Metfrag<span></span></a></li>
<li class="chapter" data-level="9.1.2" data-path="Library.html"><a href="Library.html#sirius-csi-fingerid"><i class="fa fa-check"></i><b>9.1.2</b> Sirius CSI FingerID<span></span></a></li>
<li class="chapter" data-level="9.1.3" data-path="Library.html"><a href="Library.html#cfm-id"><i class="fa fa-check"></i><b>9.1.3</b> CFM-ID<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="Library.html"><a href="Library.html#neims"><i class="fa fa-check"></i><b>9.2</b> NEIMS<span></span></a></li>
<li class="chapter" data-level="9.3" data-path="Library.html"><a href="Library.html#deepei"><i class="fa fa-check"></i><b>9.3</b> DeepEI<span></span></a></li>
<li class="chapter" data-level="9.4" data-path="Library.html"><a href="Library.html#qcxms"><i class="fa fa-check"></i><b>9.4</b> QCxMS<span></span></a></li>
<li class="chapter" data-level="9.5" data-path="Library.html"><a href="Library.html#library-search"><i class="fa fa-check"></i><b>9.5</b> LIBRARY SEARCH<span></span></a></li>
<li class="chapter" data-level="9.6" data-path="Library.html"><a href="Library.html#reading-mgf-files-in-r"><i class="fa fa-check"></i><b>9.6</b> Reading mgf files in R<span></span></a></li>
<li class="chapter" data-level="9.7" data-path="Library.html"><a href="Library.html#lib2nist-1"><i class="fa fa-check"></i><b>9.7</b> LIB2NIST<span></span></a></li>
<li class="chapter" data-level="9.8" data-path="Library.html"><a href="Library.html#mspepsearch"><i class="fa fa-check"></i><b>9.8</b> MSPepSearch<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="PostProcessing.html"><a href="PostProcessing.html"><i class="fa fa-check"></i><b>10</b> <strong>Data post-processing</strong><span></span></a>
<ul>
<li class="chapter" data-level="10.1" data-path="PostProcessing.html"><a href="PostProcessing.html#hierarchical-clustering"><i class="fa fa-check"></i><b>10.1</b> Hierarchical clustering<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ExampleDust.html"><a href="ExampleDust.html"><i class="fa fa-check"></i><b>11</b> Example workflow: indoor dust<span></span></a>
<ul>
<li class="chapter" data-level="11.1" data-path="ExampleDust.html"><a href="ExampleDust.html#gc-orbitrap-hrms-workflow"><i class="fa fa-check"></i><b>11.1</b> GC orbitrap HRMS workflow<span></span></a></li>
<li class="chapter" data-level="11.2" data-path="ExampleDust.html"><a href="ExampleDust.html#lc-hrms-using-waters-mse-dia-workflow"><i class="fa fa-check"></i><b>11.2</b> LC-HRMS using Waters MSe DIA workflow<span></span></a></li>
<li class="chapter" data-level="11.3" data-path="ExampleDust.html"><a href="ExampleDust.html#workflow-for-centroiding-of-raw-file-peak-picking-and-correlation-of-ms1-and-ms2"><i class="fa fa-check"></i><b>11.3</b> Workflow for centroiding of raw file, peak picking and correlation of MS1 and MS2<span></span></a></li>
<li class="chapter" data-level="11.4" data-path="ExampleDust.html"><a href="ExampleDust.html#first-convert-unifi-data-using-msconvert"><i class="fa fa-check"></i><b>11.4</b> First convert unifi data using MSConvert<span></span></a></li>
<li class="chapter" data-level="11.5" data-path="ExampleDust.html"><a href="ExampleDust.html#centroiding-raw-data-from-mzml-using-msnbase"><i class="fa fa-check"></i><b>11.5</b> Centroiding raw data from mzML using MSnbase<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ExamplePFAS.html"><a href="ExamplePFAS.html"><i class="fa fa-check"></i><b>12</b> Example workflow: PFASs<span></span></a></li>
<li class="chapter" data-level="13" data-path="DataConversion.html"><a href="DataConversion.html"><i class="fa fa-check"></i><b>13</b> Conversion of raw data from HRMS vendor format to open format<span></span></a>
<ul>
<li class="chapter" data-level="13.1" data-path="DataConversion.html"><a href="DataConversion.html#MSConvertGC"><i class="fa fa-check"></i><b>13.1</b> GC orbitrap HRMS: convert .raw data to .mzML using MSconvert<span></span></a></li>
<li class="chapter" data-level="13.2" data-path="DataConversion.html"><a href="DataConversion.html#MSConvertunifi"><i class="fa fa-check"></i><b>13.2</b> LC-HRMS: convert the raw data file from unifi to mzML using MSconvert<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="GClib.html"><a href="GClib.html"><i class="fa fa-check"></i><b>14</b> MTM HRMS Library: GC-HRMS<span></span></a>
<ul>
<li class="chapter" data-level="14.1" data-path="GClib.html"><a href="GClib.html#analyze-the-standards-using-hrms"><i class="fa fa-check"></i><b>14.1</b> Analyze the standards using HRMS<span></span></a></li>
<li class="chapter" data-level="14.2" data-path="GClib.html"><a href="GClib.html#convert-the-raw-data-file-from-gc-hrms-analysis-to-.mzml-using-msconvert-for-unifi-conversion-see-section-refmsconvertgc"><i class="fa fa-check"></i><b>14.2</b> Convert the raw data file from GC-HRMS analysis to .mzML using MSconvert (For unifi conversion, see section @ref(MSConvertGC)<span></span></a></li>
<li class="chapter" data-level="14.3" data-path="GClib.html"><a href="GClib.html#fill-in-the-standard-infosheet"><i class="fa fa-check"></i><b>14.3</b> Fill in the standard infosheet<span></span></a></li>
<li class="chapter" data-level="14.4" data-path="GClib.html"><a href="GClib.html#use-ms-dial-to-perform-spectral-deconvolution-and-generate-spectra-for-each-compound"><i class="fa fa-check"></i><b>14.4</b> Use MS-DIAL to perform spectral deconvolution and generate spectra for each compound<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="mtm-hrms-library-lc-hrms.html"><a href="mtm-hrms-library-lc-hrms.html"><i class="fa fa-check"></i><b>15</b> MTM HRMS Library: LC-HRMS<span></span></a>
<ul>
<li class="chapter" data-level="15.1" data-path="mtm-hrms-library-lc-hrms.html"><a href="mtm-hrms-library-lc-hrms.html#analyze-the-standards-using-hrms-1"><i class="fa fa-check"></i><b>15.1</b> Analyze the standards using HRMS<span></span></a></li>
<li class="chapter" data-level="15.2" data-path="mtm-hrms-library-lc-hrms.html"><a href="mtm-hrms-library-lc-hrms.html#convert-the-raw-data-file-from-lc-hrms-in-unifi-to-mzml-using-msconvert"><i class="fa fa-check"></i><b>15.2</b> Convert the raw data file from LC-HRMS in unifi to mzML using MSconvert<span></span></a></li>
<li class="chapter" data-level="15.3" data-path="mtm-hrms-library-lc-hrms.html"><a href="mtm-hrms-library-lc-hrms.html#fill-in-the-standard-infosheet-1"><i class="fa fa-check"></i><b>15.3</b> Fill in the standard infosheet<span></span></a></li>
<li class="chapter" data-level="15.4" data-path="mtm-hrms-library-lc-hrms.html"><a href="mtm-hrms-library-lc-hrms.html#use-ms-dial-to-perform-spectral-deconvolution-and-generate-spectra-for-each-compound-1"><i class="fa fa-check"></i><b>15.4</b> Use MS-DIAL to perform spectral deconvolution and generate spectra for each compound<span></span></a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="GCMSDIAL.html"><a href="GCMSDIAL.html"><i class="fa fa-check"></i><b>16</b> GC-HRMS raw data preprocessing with MS-DIAL<span></span></a>
<ul>
<li class="chapter" data-level="16.1" data-path="GCMSDIAL.html"><a href="GCMSDIAL.html#post-processing"><i class="fa fa-check"></i><b>16.1</b> Post processing<span></span></a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="GCMSDIAL.html"><a href="GCMSDIAL.html#convert-riken-msp-to-nist-to-be-compatible-with-mspepsearch"><i class="fa fa-check"></i><b>16.1.1</b> Convert RIKEN msp to NIST to be compatible with MSPepSearch<span></span></a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="GCMSDIAL.html"><a href="GCMSDIAL.html#further-explanation-for-some-terminologies-apart-from-the-tutorial-httpsmtbinfo-team.github.iomtbinfo.github.ioms-dialtutorial"><i class="fa fa-check"></i><b>16.2</b> Further explanation for some terminologies apart from the tutorial (<span>https://mtbinfo-team.github.io/mtbinfo.github.io/MS-DIAL/tutorial</span>)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="LCHRMSMSe.html"><a href="LCHRMSMSe.html"><i class="fa fa-check"></i><b>17</b> LC-HRMS MSe raw data preprocessing with MS-DIAL<span></span></a>
<ul>
<li class="chapter" data-level="17.1" data-path="LCHRMSMSe.html"><a href="LCHRMSMSe.html#some-recommended-values-for-g2-xs-qtof"><i class="fa fa-check"></i><b>17.1</b> Some recommended values for G2 XS qtof:<span></span></a></li>
<li class="chapter" data-level="17.2" data-path="LCHRMSMSe.html"><a href="LCHRMSMSe.html#post-processing-1"><i class="fa fa-check"></i><b>17.2</b> Post processing<span></span></a></li>
<li class="chapter" data-level="17.3" data-path="LCHRMSMSe.html"><a href="LCHRMSMSe.html#further-explanation-for-some-terminologies-apart-from-the-tutorial-httpsmtbinfo-team.github.iomtbinfo.github.ioms-dialtutorial-1"><i class="fa fa-check"></i><b>17.3</b> Further explanation for some terminologies apart from the tutorial (<span>https://mtbinfo-team.github.io/mtbinfo.github.io/MS-DIAL/tutorial</span>)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="GCOrbitrapHandbook.html"><a href="GCOrbitrapHandbook.html"><i class="fa fa-check"></i><b>18</b> A handbook on GC Q Exactive orbitrap use<span></span></a>
<ul>
<li class="chapter" data-level="18.1" data-path="GCOrbitrapHandbook.html"><a href="GCOrbitrapHandbook.html#acquisition-parameters"><i class="fa fa-check"></i><b>18.1</b> Acquisition parameters<span></span></a></li>
<li class="chapter" data-level="18.2" data-path="GCOrbitrapHandbook.html"><a href="GCOrbitrapHandbook.html#chemical-ionization"><i class="fa fa-check"></i><b>18.2</b> Chemical ionization<span></span></a></li>
<li class="chapter" data-level="18.3" data-path="GCOrbitrapHandbook.html"><a href="GCOrbitrapHandbook.html#terminologies-1"><i class="fa fa-check"></i><b>18.3</b> Terminologies<span></span></a></li>
<li class="chapter" data-level="18.4" data-path="GCOrbitrapHandbook.html"><a href="GCOrbitrapHandbook.html#cleaning-source"><i class="fa fa-check"></i><b>18.4</b> Cleaning source<span></span></a></li>
<li class="chapter" data-level="18.5" data-path="GCOrbitrapHandbook.html"><a href="GCOrbitrapHandbook.html#performance-mixture"><i class="fa fa-check"></i><b>18.5</b> Performance mixture<span></span></a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="reproducible-research-using-docker-containers-and-similar-tools.html"><a href="reproducible-research-using-docker-containers-and-similar-tools.html"><i class="fa fa-check"></i><b>19</b> Reproducible research using Docker containers and similar tools<span></span></a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Handbook of comprehensive suspect and nontarget workflows in environmental analysis using GC and LC-HRMS</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="MolecularNetworks" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">8</span> <strong>Molecular networks</strong><a href="MolecularNetworks.html#MolecularNetworks" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This is a chapter about molecular networks</p>
<p><br><br></p>
<div id="metgem" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> MetGem<a href="MolecularNetworks.html#metgem" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The documentation for MetGem can be found here:<br />
<em>Metgem webpage:</em> <a href="https://metgem.github.io/" class="uri">https://metgem.github.io/</a> <br>
<em>Metgem handbook:</em> <a href="https://metgem.readthedocs.io/en/latest/index.html" class="uri">https://metgem.readthedocs.io/en/latest/index.html</a> <br></p>
<p>Main steps for the dataset is to generate a combined msp or mgf file (such as from MS-DIAL or xcms) and import it to MetGem. Additional metadata should also be added to relate the ID of different compounds or unknowns.</p>
<div id="metgem-parameters" class="section level3 hasAnchor" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Metgem parameters<a href="MolecularNetworks.html#metgem-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>LC</strong>
<a href="https://pubs.acs.org/doi/10.1021/acs.analchem.8b03099" class="uri">https://pubs.acs.org/doi/10.1021/acs.analchem.8b03099</a>
MS2 spectra were window-filtered by choosing only the top six peaks in the ±50 Da window throughout the spectrum. The data were filtered by removing all peaks in the ±17 Da range around the precursor m/z. The m/z tolerance windows used to find the matching peaks was set to 0.01 Da, and cosine scores were kept under consideration for spectra sharing three matching peaks at least.
The molecular network was created where edges were filtered to have a cosine score of &gt;0.7. Further edges between two nodes were kept in the network if and only if each of the nodes appeared in each other’s respective top 10 most similar nodes. With regard to the t-SNE output, nodes were kept under consideration only if they share at least one cosine score above 0.6 with others (“at least one cosine score above 0.6” parameter). The number of iterations, perplexity, learning rate, and early exaggeration parameters were set to 1000, 6, 200, and 12, respectively. The Barnes-Hut approximation was activated using a θ angle of 0.5°. These values were initially used as a first approximation based on the scikit-learn t-SNE package default parameters. Except for the perplexity that has been reduced from 30 to 6, which was more adapted for small data sets, all these parameters looked appropriate as very well-defined clusters were clearly perceptible and the data organization was consistent with the observed fragmentation patterns.</p>
<p>Group mapping files can be used in MetGem to create groups within sample datasets depending on any observation or user’s specification (biological activity, origin of a sample, taxonomy, analytical details or whatever). These groups can further be mapped in both MNs and t-SNE graphs to ease the visualization and the analysis of data. Group mapping files must be submitted as .txt files and follow the GNPS-style format: GROUP_Active=Sample1.mzXML;Sample2.mzXML GROUP_Inactive=Sample3.mzXML;Sample4.mzXML GROUP_Blanks=Blank1.mzXML GROUP_Samples=Sample1.mzXML;Sample2.mzXML;Sample3.mzXML;Sample4.mzXML
GROUP_Active signifies that this group contains the two samples 1 and 2, MetGem will then sum up the peak area values of these two samples for each feature and display the result in a new dedicated “Active” column in the metadata table. Note that a sample can be assigned to several groups and at least one sample must appear in a specified group.</p>
<div class="figure">
<img src="images/Metgem_tsneParams.png" alt="Description of the parameters available for the t-SNE visualization" width="900" />
<p class="caption">
(#fig:MetGem_tsneParams)Description of the parameters available for the t-SNE visualization
</p>
</div>
<p>Small datasets: up to 2 000 nodes<br />
Medium Datasets: 2 000 to 10 000 nodes<br />
Large Datasets: &gt; 10 000 nodes</p>
<p>For more information, please see : <a href="https://lvdmaaten.github.io/tsne/" class="uri">https://lvdmaaten.github.io/tsne/</a> ; <a href="http://scikit-learn.org/stable/modules/manifold.html#t-sne" class="uri">http://scikit-learn.org/stable/modules/manifold.html#t-sne</a>.</p>
<p><strong>GC data</strong>
<br></p>
<ol style="list-style-type: decimal">
<li>From MSDIAL: Export “Alignment result.” check “Raw data matrix (Area)” and “Representative spectra.” Check “Filter by..blank samples.” Export format “msp.”<br />
</li>
<li>Copy the .txt file to excel. Copy the content to a new sheet. Remove top rows, select only: “Alignment ID,” “Metabolite name,” “Average Rt(min),”Quant mass”, and the areas of selected samples. Save sheet as tab delimited file (.txt). The number of rows should be the same as the number of individual queries in the msp file.</li>
</ol>
<p><strong>NOTE</strong>: For GC orbitrap data:
- When importing metadata, have the “index column” empty, instead of Alignment ID. Otherwise ID will be incorrectly assigned.
- check the treat as MS1 data<br />
- m/z tolerance: 0.01 Da<br />
- Minimum matched peaks: 6<br />
- uncheck the “Keep peaks outside of the…” box<br />
- uncheck the “Keep each peak in top…” or use a low setting such as “top 10 in the 5 Th window”<br />
- Check the “Keep peaks above 1% of maximum”<br />
Can play around with the “% peak of maxmum” and “top n” parameters to get best parameters for your purpose. Use annotated compounds or a standards msp library to check related compounds and/or metabolites and parents.</p>
<ul>
<li><p>Network parameters: cosine score: 0.65</p></li>
<li><p>t-sne parameters: cosine score: 0.6</p></li>
</ul>
<p><em>Text from authors GC method:</em>
A new option was added to the input data file dialogue. When this option is activated, input spectra are treated as MS1, and thus, the parent m/z ratio is fully ignored.</p>
<p>The molecular networks were created using MetGem 1.2.2 software (<a href="https://metgem.github.io/" class="uri">https://metgem.github.io/</a>). EI-MS spectra were window filtered by choosing only the top 6 peaks in the ±50 Da window throughout the spectrum. Cosine scores were calculated using a m/z tolerance of 0.3 Th. Networks were then created where edges were filtered to have a cosine score above 0.7 (or 0.75 in the case of GC-EI-MS data from perfumes) and more than six matched peaks. Furthermore, edges between two nodes were kept in the network if and only if each of the nodes appeared in each other’s respective top 10 most similar nodes. The library spectra were filtered in the same manner as the input data.</p>
</div>
</div>
<div id="gnps" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> GNPS<a href="MolecularNetworks.html#gnps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://gnps.ucsd.edu/" class="uri">https://gnps.ucsd.edu/</a></p>
<p><a href="https://ccms-ucsd.github.io/GNPSDocumentation/fileupload/" class="uri">https://ccms-ucsd.github.io/GNPSDocumentation/fileupload/</a></p>
<p>Carbon marker table: <a href="https://ccms-ucsd.github.io/GNPSDocumentation/gc-ms-library-molecular-network/" class="uri">https://ccms-ucsd.github.io/GNPSDocumentation/gc-ms-library-molecular-network/</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="RetentionTime.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Library.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown/edit/master/inst/examples/08-Molecular_networks.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SSANTA.pdf", "SSANTA.epub", "SSANTA.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
