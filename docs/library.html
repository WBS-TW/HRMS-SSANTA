<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Library search | Handbook of comprehensive suspect and nontarget workflows in environmental analysis using GC and LC-HRMS</title>
  <meta name="description" content="SSANTA." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Library search | Handbook of comprehensive suspect and nontarget workflows in environmental analysis using GC and LC-HRMS" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://www.oru.se/personal/thanh_wang" />
  <meta property="og:image" content="https://www.oru.se/personal/thanh_wang/images/OUR.png" />
  <meta property="og:description" content="SSANTA." />
  <meta name="github-repo" content="WBS-TW/WBS-TW.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Library search | Handbook of comprehensive suspect and nontarget workflows in environmental analysis using GC and LC-HRMS" />
  
  <meta name="twitter:description" content="SSANTA." />
  <meta name="twitter:image" content="https://www.oru.se/personal/thanh_wang/images/OUR.png" />

<meta name="author" content="Thanh Wang,   MTM Research Centre, Örebro University" />


<meta name="date" content="2021-11-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="molecular_networks.html"/>
<link rel="next" href="postprocessing.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.20/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SSA/NTA</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="Intro.html"><a href="Intro.html"><i class="fa fa-check"></i><b>1</b> <strong>Introduction and concepts</strong></a>
<ul>
<li class="chapter" data-level="1.1" data-path="Intro.html"><a href="Intro.html#terminologies"><i class="fa fa-check"></i><b>1.1</b> Terminologies</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Exp_design.html"><a href="Exp_design.html"><i class="fa fa-check"></i><b>2</b> <strong>Experimental design</strong></a>
<ul>
<li class="chapter" data-level="2.1" data-path="Exp_design.html"><a href="Exp_design.html#hypothesis"><i class="fa fa-check"></i><b>2.1</b> Hypothesis</a></li>
<li class="chapter" data-level="2.2" data-path="Exp_design.html"><a href="Exp_design.html#experimental-design"><i class="fa fa-check"></i><b>2.2</b> Experimental design</a></li>
<li class="chapter" data-level="2.3" data-path="Exp_design.html"><a href="Exp_design.html#qaqc-measures"><i class="fa fa-check"></i><b>2.3</b> QA/QC measures</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="Exp_design.html"><a href="Exp_design.html#recovery-extraction-efficieny"><i class="fa fa-check"></i><b>2.3.1</b> Recovery (Extraction efficieny)</a></li>
<li class="chapter" data-level="2.3.2" data-path="Exp_design.html"><a href="Exp_design.html#matrix-effects"><i class="fa fa-check"></i><b>2.3.2</b> Matrix effects</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="Exp_design.html"><a href="Exp_design.html#data-directory-structure"><i class="fa fa-check"></i><b>2.4</b> Data directory structure</a></li>
<li class="chapter" data-level="2.5" data-path="Exp_design.html"><a href="Exp_design.html#sampling-design-and-collection"><i class="fa fa-check"></i><b>2.5</b> Sampling design and collection</a></li>
<li class="chapter" data-level="2.6" data-path="Exp_design.html"><a href="Exp_design.html#collection-of-metadata"><i class="fa fa-check"></i><b>2.6</b> Collection of metadata</a></li>
<li class="chapter" data-level="2.7" data-path="Exp_design.html"><a href="Exp_design.html#chemical-analysis"><i class="fa fa-check"></i><b>2.7</b> Chemical analysis</a></li>
<li class="chapter" data-level="2.8" data-path="Exp_design.html"><a href="Exp_design.html#data-analysis"><i class="fa fa-check"></i><b>2.8</b> Data analysis</a></li>
<li class="chapter" data-level="2.9" data-path="Exp_design.html"><a href="Exp_design.html#workflow-examples"><i class="fa fa-check"></i><b>2.9</b> Workflow examples</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Sample_pretreatment.html"><a href="Sample_pretreatment.html"><i class="fa fa-check"></i><b>3</b> <strong>Sample pretreatment for nontarget and suspect screening</strong></a>
<ul>
<li class="chapter" data-level="3.1" data-path="Sample_pretreatment.html"><a href="Sample_pretreatment.html#accelerated-solvent-extraction-ase"><i class="fa fa-check"></i><b>3.1</b> Accelerated solvent extraction (ASE)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="MS_preprocess.html"><a href="MS_preprocess.html"><i class="fa fa-check"></i><b>4</b> <strong>Pre-processing HRMS data</strong></a>
<ul>
<li class="chapter" data-level="4.1" data-path="MS_preprocess.html"><a href="MS_preprocess.html#peak-picking"><i class="fa fa-check"></i><b>4.1</b> Peak picking</a></li>
<li class="chapter" data-level="4.2" data-path="MS_preprocess.html"><a href="MS_preprocess.html#open-tools-for-preprocessing"><i class="fa fa-check"></i><b>4.2</b> Open tools for preprocessing</a></li>
<li class="chapter" data-level="4.3" data-path="MS_preprocess.html"><a href="MS_preprocess.html#openms-and-toppview"><i class="fa fa-check"></i><b>4.3</b> OpenMS and Toppview</a></li>
<li class="chapter" data-level="4.4" data-path="MS_preprocess.html"><a href="MS_preprocess.html#msnbase-and-xcms"><i class="fa fa-check"></i><b>4.4</b> MsnBase and XCMS</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="MS_preprocess.html"><a href="MS_preprocess.html#xcms"><i class="fa fa-check"></i><b>4.4.1</b> XCMS</a></li>
<li class="chapter" data-level="4.4.2" data-path="MS_preprocess.html"><a href="MS_preprocess.html#camera"><i class="fa fa-check"></i><b>4.4.2</b> CAMERA</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="MS_preprocess.html"><a href="MS_preprocess.html#patroon"><i class="fa fa-check"></i><b>4.5</b> PatRoon</a></li>
<li class="chapter" data-level="4.6" data-path="MS_preprocess.html"><a href="MS_preprocess.html#ms-dial"><i class="fa fa-check"></i><b>4.6</b> MS-DIAL</a></li>
<li class="chapter" data-level="4.7" data-path="MS_preprocess.html"><a href="MS_preprocess.html#output-formats"><i class="fa fa-check"></i><b>4.7</b> Output formats</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="suspect_screening.html"><a href="suspect_screening.html"><i class="fa fa-check"></i><b>5</b> <strong>Suspect screening</strong></a>
<ul>
<li class="chapter" data-level="5.1" data-path="suspect_screening.html"><a href="suspect_screening.html#lib2nist"><i class="fa fa-check"></i><b>5.1</b> LIB2NIST</a></li>
<li class="chapter" data-level="5.2" data-path="suspect_screening.html"><a href="suspect_screening.html#listing-suspects"><i class="fa fa-check"></i><b>5.2</b> Listing suspects</a></li>
<li class="chapter" data-level="5.3" data-path="suspect_screening.html"><a href="suspect_screening.html#suspect-scoring"><i class="fa fa-check"></i><b>5.3</b> Suspect scoring</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="mass_defect.html"><a href="mass_defect.html"><i class="fa fa-check"></i><b>6</b> <strong>Mass defect plots</strong></a>
<ul>
<li class="chapter" data-level="6.1" data-path="mass_defect.html"><a href="mass_defect.html#mdplotr"><i class="fa fa-check"></i><b>6.1</b> MDPlotR</a></li>
<li class="chapter" data-level="6.2" data-path="mass_defect.html"><a href="mass_defect.html#findhalo"><i class="fa fa-check"></i><b>6.2</b> findhalo</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="retention_times.html"><a href="retention_times.html"><i class="fa fa-check"></i><b>7</b> <strong>Retention time index and prediction</strong></a>
<ul>
<li class="chapter" data-level="7.1" data-path="retention_times.html"><a href="retention_times.html#lc"><i class="fa fa-check"></i><b>7.1</b> LC</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="retention_times.html"><a href="retention_times.html#retip---retention-time-prediction-for-metabolomics"><i class="fa fa-check"></i><b>7.1.1</b> Retip - Retention Time prediction for Metabolomics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="molecular_networks.html"><a href="molecular_networks.html"><i class="fa fa-check"></i><b>8</b> <strong>Molecular networks</strong></a>
<ul>
<li class="chapter" data-level="8.1" data-path="molecular_networks.html"><a href="molecular_networks.html#metgem"><i class="fa fa-check"></i><b>8.1</b> MetGem</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="molecular_networks.html"><a href="molecular_networks.html#gc-data"><i class="fa fa-check"></i><b>8.1.1</b> GC data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="library.html"><a href="library.html"><i class="fa fa-check"></i><b>9</b> <strong>Library search</strong></a>
<ul>
<li class="chapter" data-level="9.1" data-path="library.html"><a href="library.html#in-silico-fragmentation"><i class="fa fa-check"></i><b>9.1</b> IN SILICO FRAGMENTATION</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="library.html"><a href="library.html#metfrag"><i class="fa fa-check"></i><b>9.1.1</b> Metfrag</a></li>
<li class="chapter" data-level="9.1.2" data-path="library.html"><a href="library.html#sirius-csi-fingerid"><i class="fa fa-check"></i><b>9.1.2</b> Sirius CSI FingerID</a></li>
<li class="chapter" data-level="9.1.3" data-path="library.html"><a href="library.html#cfm-id"><i class="fa fa-check"></i><b>9.1.3</b> CFM-ID</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="library.html"><a href="library.html#neims"><i class="fa fa-check"></i><b>9.2</b> NEIMS</a></li>
<li class="chapter" data-level="9.3" data-path="library.html"><a href="library.html#deepei"><i class="fa fa-check"></i><b>9.3</b> DeepEI</a></li>
<li class="chapter" data-level="9.4" data-path="library.html"><a href="library.html#qceims"><i class="fa fa-check"></i><b>9.4</b> QCEIMS</a></li>
<li class="chapter" data-level="9.5" data-path="library.html"><a href="library.html#library-search"><i class="fa fa-check"></i><b>9.5</b> LIBRARY SEARCH</a></li>
<li class="chapter" data-level="9.6" data-path="library.html"><a href="library.html#reading-mgf-files-in-r"><i class="fa fa-check"></i><b>9.6</b> Reading mgf files in R</a></li>
<li class="chapter" data-level="9.7" data-path="library.html"><a href="library.html#lib2nist-1"><i class="fa fa-check"></i><b>9.7</b> LIB2NIST</a></li>
<li class="chapter" data-level="9.8" data-path="library.html"><a href="library.html#mspepsearch"><i class="fa fa-check"></i><b>9.8</b> MSPepSearch</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="postprocessing.html"><a href="postprocessing.html"><i class="fa fa-check"></i><b>10</b> <strong>Data post-processing</strong></a>
<ul>
<li class="chapter" data-level="10.1" data-path="postprocessing.html"><a href="postprocessing.html#hierarchical-clustering"><i class="fa fa-check"></i><b>10.1</b> Hierarchical clustering</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="example_dust.html"><a href="example_dust.html"><i class="fa fa-check"></i><b>11</b> Example workflow: indoor dust</a>
<ul>
<li class="chapter" data-level="11.1" data-path="example_dust.html"><a href="example_dust.html#gc-orbitrap-hrms-workflow"><i class="fa fa-check"></i><b>11.1</b> <strong>GC orbitrap HRMS workflow</strong></a></li>
<li class="chapter" data-level="11.2" data-path="example_dust.html"><a href="example_dust.html#lc-hrms-using-waters-mse-dia-workflow"><i class="fa fa-check"></i><b>11.2</b> <strong>LC-HRMS using Waters MSe DIA workflow</strong></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="workflow-for-centroiding-of-raw-file-peak-picking-and-correlation-of-ms1-and-ms2.html"><a href="workflow-for-centroiding-of-raw-file-peak-picking-and-correlation-of-ms1-and-ms2.html"><i class="fa fa-check"></i><b>12</b> Workflow for centroiding of raw file, peak picking and correlation of MS1 and MS2</a>
<ul>
<li class="chapter" data-level="12.1" data-path="workflow-for-centroiding-of-raw-file-peak-picking-and-correlation-of-ms1-and-ms2.html"><a href="workflow-for-centroiding-of-raw-file-peak-picking-and-correlation-of-ms1-and-ms2.html#first-convert-unifi-data-using-msconvert"><i class="fa fa-check"></i><b>12.1</b> First convert unifi data using MSConvert</a></li>
<li class="chapter" data-level="12.2" data-path="workflow-for-centroiding-of-raw-file-peak-picking-and-correlation-of-ms1-and-ms2.html"><a href="workflow-for-centroiding-of-raw-file-peak-picking-and-correlation-of-ms1-and-ms2.html#centroiding-raw-data-from-mzml-using-msnbase"><i class="fa fa-check"></i><b>12.2</b> Centroiding raw data from mzML using MSnbase</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="example_pfas.html"><a href="example_pfas.html"><i class="fa fa-check"></i><b>13</b> Example workflow: PFASs</a></li>
<li class="chapter" data-level="14" data-path="mtm-hrms-library-gc-hrms.html"><a href="mtm-hrms-library-gc-hrms.html"><i class="fa fa-check"></i><b>14</b> MTM HRMS Library: GC-HRMS</a>
<ul>
<li class="chapter" data-level="14.1" data-path="mtm-hrms-library-gc-hrms.html"><a href="mtm-hrms-library-gc-hrms.html#analyze-the-standards-using-hrms"><i class="fa fa-check"></i><b>14.1</b> Analyze the standards using HRMS</a></li>
<li class="chapter" data-level="14.2" data-path="mtm-hrms-library-gc-hrms.html"><a href="mtm-hrms-library-gc-hrms.html#convert-the-raw-data-file-from-gc-hrms-analysis-to-.mzml-using-msconvert-for-unifi-conversion-see-section-xx"><i class="fa fa-check"></i><b>14.2</b> Convert the raw data file from GC-HRMS analysis to .mzML using MSconvert (For unifi conversion, see section XX)</a></li>
<li class="chapter" data-level="14.3" data-path="mtm-hrms-library-gc-hrms.html"><a href="mtm-hrms-library-gc-hrms.html#fill-in-the-standard-infosheet"><i class="fa fa-check"></i><b>14.3</b> Fill in the standard infosheet</a></li>
<li class="chapter" data-level="14.4" data-path="mtm-hrms-library-gc-hrms.html"><a href="mtm-hrms-library-gc-hrms.html#use-ms-dial-to-perform-spectral-deconvolution-and-generate-spectra-for-each-compound"><i class="fa fa-check"></i><b>14.4</b> Use MS-DIAL to perform spectral deconvolution and generate spectra for each compound</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="mtm-hrms-library-lc-hrms.html"><a href="mtm-hrms-library-lc-hrms.html"><i class="fa fa-check"></i><b>15</b> MTM HRMS Library: LC-HRMS</a>
<ul>
<li class="chapter" data-level="15.1" data-path="mtm-hrms-library-lc-hrms.html"><a href="mtm-hrms-library-lc-hrms.html#analyze-the-standards-using-hrms-1"><i class="fa fa-check"></i><b>15.1</b> Analyze the standards using HRMS</a></li>
<li class="chapter" data-level="15.2" data-path="mtm-hrms-library-lc-hrms.html"><a href="mtm-hrms-library-lc-hrms.html#convert-the-raw-data-file-from-lc-hrms-in-unifi-to-mzml-using-msconvert"><i class="fa fa-check"></i><b>15.2</b> Convert the raw data file from LC-HRMS in unifi to mzML using MSconvert</a></li>
<li class="chapter" data-level="15.3" data-path="mtm-hrms-library-lc-hrms.html"><a href="mtm-hrms-library-lc-hrms.html#fill-in-the-standard-infosheet-1"><i class="fa fa-check"></i><b>15.3</b> Fill in the standard infosheet</a></li>
<li class="chapter" data-level="15.4" data-path="mtm-hrms-library-lc-hrms.html"><a href="mtm-hrms-library-lc-hrms.html#use-ms-dial-to-perform-spectral-deconvolution-and-generate-spectra-for-each-compound-1"><i class="fa fa-check"></i><b>15.4</b> Use MS-DIAL to perform spectral deconvolution and generate spectra for each compound</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="a-handbook-on-gc-q-exactive-orbitrap-use.html"><a href="a-handbook-on-gc-q-exactive-orbitrap-use.html"><i class="fa fa-check"></i><b>16</b> A handbook on GC Q Exactive orbitrap use</a>
<ul>
<li class="chapter" data-level="16.1" data-path="a-handbook-on-gc-q-exactive-orbitrap-use.html"><a href="a-handbook-on-gc-q-exactive-orbitrap-use.html#terminologies-1"><i class="fa fa-check"></i><b>16.1</b> Terminologies</a></li>
<li class="chapter" data-level="16.2" data-path="a-handbook-on-gc-q-exactive-orbitrap-use.html"><a href="a-handbook-on-gc-q-exactive-orbitrap-use.html#xcms-preprocessing"><i class="fa fa-check"></i><b>16.2</b> XCMS preprocessing</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="reproducible-research-using-docker-containers-and-similar-tools.html"><a href="reproducible-research-using-docker-containers-and-similar-tools.html"><i class="fa fa-check"></i><b>17</b> Reproducible research using Docker containers and similar tools</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Handbook of comprehensive suspect and nontarget workflows in environmental analysis using GC and LC-HRMS</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="library" class="section level1" number="9">
<h1><span class="header-section-number">9</span> <strong>Library search</strong></h1>
<p>In environmental analysis, NIST MS library is widely used to match a spectrum to a list of standard spectra. However, a major drawback of the NIST MS Search is that now all chemicals are included and all spectral ions are at unit mass (for EI spectra library, also called mainlib)</p>
<p>Below figure shows a relatively good spectral match for a standard if only nominal or even at 0.1 decimal m/z:</p>
<div class="figure"><span style="display:block;" id="fig:spectrum1"></span>
<img src="images/Spectra_CFBP_MePDA.PNG" alt="Spectral matching (using MS-DIAL)" width="696" />
<p class="caption">
Figure 9.1: Spectral matching (using MS-DIAL)
</p>
</div>
<p><img src="images/forward_reverse_lib_search.png" width="1779" /></p>
<div id="in-silico-fragmentation" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> IN SILICO FRAGMENTATION</h2>
<p>There are several openly available models that have recently been published to predict the fragmentation patterns of GC-EI MS.</p>
<div id="metfrag" class="section level3" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Metfrag</h3>
</div>
<div id="sirius-csi-fingerid" class="section level3" number="9.1.2">
<h3><span class="header-section-number">9.1.2</span> Sirius CSI FingerID</h3>
</div>
<div id="cfm-id" class="section level3" number="9.1.3">
<h3><span class="header-section-number">9.1.3</span> CFM-ID</h3>
<p>In silico fragmentation:<br />
Help file: <a href="https://sourceforge.net/p/cfm-id/wiki/Home/" class="uri">https://sourceforge.net/p/cfm-id/wiki/Home/</a></p>
<p><em>Use instructions:</em></p>
<ul>
<li>If you are using EI-MS (GC-MS) data, please use the ei_ms_model provided.<br />
</li>
<li>Note that lpsolve55.dll must also be included in the same directory as the executables. This file can be found in the development version of LPSolve (e.g. lp_solve_5.5.2.0_dev_win32.zip), which can be downloaded from <a href="https://sourceforge.net/projects/lpsolve/files/lpsolve/5.5.2.5/lp_solve_5.5.2.5_dev_win32.zip/download" class="uri">https://sourceforge.net/projects/lpsolve/files/lpsolve/5.5.2.5/lp_solve_5.5.2.5_dev_win32.zip/download</a>.</li>
</ul>
<p>Cfm-predict</p>
<p>COMMAND:<br />
<code>cfm-predict.exe &lt;smiles_or_inchi_or_file&gt; &lt;prob_thresh&gt; &lt;param_file&gt; &lt;config_file&gt; &lt;annotate_fragments&gt; &lt;output_file_or_dir&gt; &lt;apply_postproc&gt; &lt;suppress_exceptions&gt;</code></p>
<p><br></p>
<p>EXAMPLE (naphthalene):<br />
<code>cfm-predict.exe InChI=1S/C10H8/c1-2-6-10-8-4-3-7-9(10)5-1/h1-8H 0.001 D:/Program/cfm-id-2.4_win32/ei_nn_iso_new/param_output.log D:/Program/cfm-id-2.4_win32/ei_nn_iso_new/param_config.txt 0 D:/Program/cfm-id-2.4_win32/test/output.msp</code></p>
<p><br></p>
<p>EXAMPLE (.txt file as input):<br />
<code>cfm-predict.exe D:/Program/cfm-id-2.4_win32/test/input.txt 0.001 D:/Program/cfm-id-2.4_win32/ei_nn_iso_new/param_output.log D:/Program/cfm-id-2.4_win32/ei_nn_iso_new/param_config.txt 0 D:/Program/cfm-id-2.4_win32/test/output.msp</code></p>
<p><br><br><br></p>
</div>
</div>
<div id="neims" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> NEIMS</h2>
<p>Help files: <a href="https://github.com/brain-research/deep-molecular-massspec" class="uri">https://github.com/brain-research/deep-molecular-massspec</a></p>
<p><br><br><br></p>
</div>
<div id="deepei" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> DeepEI</h2>
<p>Help files: <a href="https://github.com/hcji/DeepEI" class="uri">https://github.com/hcji/DeepEI</a><br />
<a href="https://github.com/hcji/DeepEI/blob/master/Usage.ipynb" class="uri">https://github.com/hcji/DeepEI/blob/master/Usage.ipynb</a></p>
<p><br><br><br></p>
</div>
<div id="qceims" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> QCEIMS</h2>
<p>RUN ON LINUX SERVER</p>
<p>Check <a href="https://www.chemie.uni-bonn.de/pctc/mulliken-center/software/movies_grimme/QCEIMS.v.4.0_manual.pdf">online manual</a> for details</p>
<p>PREPARATION<br />
Copy the “.XTBPARAM” folder and the “.mass_raw.agr” file to /home/ORUNET.ORU.SE/twg/</p>
<ol style="list-style-type: decimal">
<li>Prepare a file with the equilibrium structure of your desired molecule M.
Important: This file has to be named coord and should have the TURBOMOLE coord format (tmol).
In most cases you will have an .xyz file. This file can be easily converted by typing:</li>
</ol>
<blockquote>
<p>x2t <xyzfile> &gt; coord</p>
</blockquote>
<p>if you have installed TURBOMOLE. If you do not have TURBOMOLE, you may have to write a
script converting .xyz files to TUROBOMOLE coord files. Be advised that the coord file has
to be in atomic units.<br />
NOTE: this can be converted using openbabel -&gt; tmol</p>
<ol start="2" style="list-style-type: decimal">
<li>Prepare an input file called qceims.in. For the input options, see section 4 or the
qceims.in file in the examples folder. If no such file is prepared, default options are:
run GFN1-xTB with 25 times the number of atoms in the molecule trajectories (ntraj).</li>
</ol>
<p>TO RUN QCEIMS</p>
<p>Open bash</p>
<ol style="list-style-type: decimal">
<li>Enable overwriting files:</li>
</ol>
<pre><code>set +o noclobber</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Enable the QCEIMS executables in the path:</li>
</ol>
<pre><code>export PATH=/home/ORUNET.ORU.SE/twg/QCEIMS/:/home/ORUNET.ORU.SE/twg/bin:/home/ORUNET.ORU.SE/twg/.local/bin:/bin:/usr/bin:/opt/thinlinc/bin:/usr/local/bin:/usr/bin/X11:/sbin:/usr/sbin:/usr/local/sbin:/snap/bin:/opt/thinlinc/bin:/opt/SPAdes/SPAdes-3.13.0-Linux/bin:/opt/mauve/mauve_snapshot_2015-02-13:/opt/parsnp/Parsnp-Linux64-v1.2:/opt/prokka/prokka-master/bin:/opt/artemis/artemis</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>go to your folder, e.g:</li>
</ol>
<pre><code>cd QCEIMS/example/ethanol</code></pre>
<p>Run:</p>
<pre><code>qceims</code></pre>
<p>Run qceims again and check the ouput if all is ok.</p>
<ol start="5" style="list-style-type: decimal">
<li>Executing production runs.
Running qceims locally, use: pqceims &lt;#cores&gt;, where &lt;#cores&gt; is the number of cores requested.
e.g for 10 cores:</li>
</ol>
<pre><code>pqceims 10</code></pre>
<p>You might want to leave your work station and even log out in the meantime. In this case, type (for 10 cores):</p>
<pre><code>pqceims 10 &amp;</code></pre>
<p>Optionally, check the status of your QCEIMS run by changing to your working directory
and typing</p>
<pre><code>getres</code></pre>
<p>, which will provide an output of the form:
<em>XXX runs done and written to tmpqceims.res/out</em>
which gathers the runs already finished (creates tmpqceims.res and tmpqceims.out).
The final results are on qceims.out and qceims.res</p>
<ol start="6" style="list-style-type: decimal">
<li><p>download an exp. EI-MS from the NIST if available and copy it to the working dir as exp.dat
(take the JCAMP-DX format from their web page). - Useful for testing but not necessary. -</p></li>
<li><p>get spectrum by</p></li>
</ol>
<pre><code>plotms</code></pre>
<p>and plot it with</p>
<pre><code>xmgrace mass.agr</code></pre>
<p>the file “.mass.agr” should be in your home dir.
plotms reads by default &lt;qceims.res&gt; or by</p>
<pre><code>plotms -f &lt;name_of_res_file&gt;</code></pre>
<p>any other res file. Check the consistency of the total charge.</p>
<p>7.2. if high resolution spectrum is needed then copy the plotms executable from the QCEIMS-HRMSplotMS folder and replace. Rename the <em>qceims.res</em> file to <em>qcxms.res</em> and run <code>plotms</code>.</p>
<ol start="8" style="list-style-type: decimal">
<li>if the ratio of fragment to M+ signals is too large decrease the IEE by increasing the parameter
ieeatm (default is 0.6 eV/atom) by inserting</li>
</ol>
<pre><code>ieeatm  &lt;value&gt;</code></pre>
<p>in qceims.in and do the parallel run again (requires an additional qceims pre-run).</p>
<ol start="9" style="list-style-type: decimal">
<li>if the IEE is ok, increase ntraj to get better statistics and re-run
(note: qceims.res is appended so delete it at this point).</li>
</ol>
<p>VERY IMPORTANT: EVERY CHANGE IN THE INPUT REQUIRES A RUN OF QCEIMS IN THE WORKING DIR
BEFORE THE PARALLEL SCRIPT IS STARTED IN ORDER TO BE IN EFFECT!</p>
<ol start="10" style="list-style-type: decimal">
<li><p>trajectories are in TMPQCEIMS/TMP.<run_number>
they are numbered by the run and the ion tracking number.
(something like gmolden TMPQCEIMS/TMP.$1/trj.$1.$2
gives trajectory $1, track $2)</p></li>
<li><p>for more QCEIMS code options (model parameters) see manual</p></li>
</ol>
<p>useful options for qceims:</p>
<p>-c : check IEE but do nothing (requires M trajectory)
-p : normal production (fragmentation) mode. Possible in any
existing TMPQCEIMS/TMP.$1 directory.
-eonly : use the requested QC (as specified in qceims.in)
and do a single-point energy
-e0 : same as above, charge = 0
-e1 : same as above, charge = 1
-qcp <string>
: string = path to the QC code /usr/local/bin is default)</p>
<p>other important options in &lt;qceims.in&gt;:</p>
<p>ip-<method>
ntraj <int>
ieeatm <real>
iseed <int> (random number initialization to start different runs)</p>
</div>
<div id="library-search" class="section level2" number="9.5">
<h2><span class="header-section-number">9.5</span> LIBRARY SEARCH</h2>
<p>xx</p>
</div>
<div id="reading-mgf-files-in-r" class="section level2" number="9.6">
<h2><span class="header-section-number">9.6</span> Reading mgf files in R</h2>
</div>
<div id="lib2nist-1" class="section level2" number="9.7">
<h2><span class="header-section-number">9.7</span> LIB2NIST</h2>
<p>Convert your library list into NIST library format using LIB2NIST command line (in order to preserve the accurate mass). See command line help file for arguments.</p>
<p>COMMAND:<br />
<code>lib2nist.exe /log9 Mylib.log /OutLib /StdRounding:N /MsmsOnly:Y /AccuratePeakMZ /PrecurMzDecPlaces=keep /PeakMzDecPlaces=keep /UseSubset:N &lt;path to msp file&gt; &lt;output path&gt; =&lt;new name of library&gt;</code></p>
<p>EXAMPLES:<br />
<code>lib2nist64.exe /log9 Mylib.log /OutLib /StdRounding:N /MsmsOnly:Y /AccuratePeakMZ /PrecurMzDecPlaces=keep /PeakMzDecPlaces=keep /UseSubset:N D:\Projects\Suspect_lists\Spectral_databases\RECETOX_GC-EI_MS_20201028.msp D:\Program\NIST14\ =RECETOX_GC-EI_MS_20201028</code></p>
<p><br><br><br></p>
</div>
<div id="mspepsearch" class="section level2" number="9.8">
<h2><span class="header-section-number">9.8</span> MSPepSearch</h2>
<p>Use MSPepSearch to find similar spectra</p>
<p>EXAMPLES:<br />
<code>MSPepSearch64.exe Gusviqh /ZI 0.1 /ZIPPM 20 /MPPM 30 /MzLimits 50 -1 /MinMF 10 /OnlyFound /HITS 5 /LIB D:\Raw_data\Dust_Florian\GC\test\Mylib /INP D:\Raw_data\Dust_Florian\GC\test\input.msp /OUTMGF D:\Raw_data\Dust_Florian\GC\test\test.mgf /OUTTAB D:\Raw_data\Dust_Florian\GC\test\test.tsv /OutMW</code></p>
<p><code>MSPepSearch64.exe Gusviqh /ZI 0.1 /ZIPPM 20 /MPPM 30 /MzLimits 50 -1 /MinMF 100 /OnlyFound /HITS 5 /LIB C:\NIST14\NIST_contaminants_orbitrap /INP D:\Projects\Mexico_Air\NIST_Mexico.msp /OUTMGF D:\Projects\Mexico_Air\test\test.mgf /OUTTAB D:\Projects\Mexico_Air\test\test.tsv</code></p>
<p><code>MSPepSearch64.exe Gusviqh /ZI 0.01 /ZIPPM 10 /MPPM 10 /MzLimits 50 -1 /MinMF 500 /OnlyFound /HITS 5 /LIB C:\NIST14\LCMs_GC_Orbitrap /INP D:\Raw_data\Dust_Florian\GC\test\11.msp /OUTMGF D:\Raw_data\Dust_Florian\GC\test\test.mgf /OUTTAB D:\Raw_data\Dust_Florian\GC\test\test.tsv</code></p>
<p>More info on commands on:
<a href="https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.9b03415/suppl_file/ac9b03415_si_001.pdf" class="uri">https://pubs.acs.org/doi/suppl/10.1021/acs.analchem.9b03415/suppl_file/ac9b03415_si_001.pdf</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="molecular_networks.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="postprocessing.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown/edit/master/inst/examples/09-library_search.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SSANTA.pdf", "SSANTA.epub", "SSANTA.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
