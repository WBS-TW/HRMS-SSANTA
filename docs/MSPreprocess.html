<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Pre-processing HRMS data | Handbook of comprehensive suspect and nontarget workflows in environmental analysis using GC and LC-HRMS</title>
  <meta name="description" content="SSANTA." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Pre-processing HRMS data | Handbook of comprehensive suspect and nontarget workflows in environmental analysis using GC and LC-HRMS" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://www.oru.se/personal/thanh_wang/images/ORU.png" />
  <meta property="og:description" content="SSANTA." />
  <meta name="github-repo" content="WBS-TW/WBS-TW.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Pre-processing HRMS data | Handbook of comprehensive suspect and nontarget workflows in environmental analysis using GC and LC-HRMS" />
  
  <meta name="twitter:description" content="SSANTA." />
  <meta name="twitter:image" content="https://www.oru.se/personal/thanh_wang/images/ORU.png" />

<meta name="author" content="Thanh Wang,   MTM Research Centre, Örebro University" />


<meta name="date" content="2022-04-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="SamplePretreatment.html"/>
<link rel="next" href="suspectScreening.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.9/grViz.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.22/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SSA/NTA</a></li>

<li class="divider"></li>
<li><a href="index.html#preface">Preface<span></span></a></li>
<li class="chapter" data-level="1" data-path="Intro.html"><a href="Intro.html"><i class="fa fa-check"></i><b>1</b> <strong>Introduction and concepts</strong><span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="Intro.html"><a href="Intro.html#terminologies"><i class="fa fa-check"></i><b>1.1</b> Terminologies<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ExpDesign.html"><a href="ExpDesign.html"><i class="fa fa-check"></i><b>2</b> <strong>Experimental design</strong><span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="ExpDesign.html"><a href="ExpDesign.html#hypothesis"><i class="fa fa-check"></i><b>2.1</b> Hypothesis<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="ExpDesign.html"><a href="ExpDesign.html#experimental-design"><i class="fa fa-check"></i><b>2.2</b> Experimental design<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="ExpDesign.html"><a href="ExpDesign.html#qaqc-measures"><i class="fa fa-check"></i><b>2.3</b> QA/QC measures<span></span></a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="ExpDesign.html"><a href="ExpDesign.html#recovery-extraction-efficieny"><i class="fa fa-check"></i><b>2.3.1</b> Recovery (Extraction efficieny)<span></span></a></li>
<li class="chapter" data-level="2.3.2" data-path="ExpDesign.html"><a href="ExpDesign.html#matrix-effects"><i class="fa fa-check"></i><b>2.3.2</b> Matrix effects<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="ExpDesign.html"><a href="ExpDesign.html#data-directory-structure"><i class="fa fa-check"></i><b>2.4</b> Data directory structure<span></span></a></li>
<li class="chapter" data-level="2.5" data-path="ExpDesign.html"><a href="ExpDesign.html#sampling-design-and-collection"><i class="fa fa-check"></i><b>2.5</b> Sampling design and collection<span></span></a></li>
<li class="chapter" data-level="2.6" data-path="ExpDesign.html"><a href="ExpDesign.html#collection-of-metadata"><i class="fa fa-check"></i><b>2.6</b> Collection of metadata<span></span></a></li>
<li class="chapter" data-level="2.7" data-path="ExpDesign.html"><a href="ExpDesign.html#chemical-analysis"><i class="fa fa-check"></i><b>2.7</b> Chemical analysis<span></span></a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="ExpDesign.html"><a href="ExpDesign.html#data-recording-modes"><i class="fa fa-check"></i><b>2.7.1</b> Data recording modes<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="ExpDesign.html"><a href="ExpDesign.html#data-analysis"><i class="fa fa-check"></i><b>2.8</b> Data analysis<span></span></a></li>
<li class="chapter" data-level="2.9" data-path="ExpDesign.html"><a href="ExpDesign.html#workflow-examples"><i class="fa fa-check"></i><b>2.9</b> Workflow examples<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="SamplePretreatment.html"><a href="SamplePretreatment.html"><i class="fa fa-check"></i><b>3</b> <strong>Sample pretreatment for nontarget and suspect screening</strong><span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="SamplePretreatment.html"><a href="SamplePretreatment.html#accelerated-solvent-extraction-ase"><i class="fa fa-check"></i><b>3.1</b> Accelerated solvent extraction (ASE)<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="SamplePretreatment.html"><a href="SamplePretreatment.html#ultrasonic-extraction"><i class="fa fa-check"></i><b>3.2</b> Ultrasonic extraction<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="MSPreprocess.html"><a href="MSPreprocess.html"><i class="fa fa-check"></i><b>4</b> <strong>Pre-processing HRMS data</strong><span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="MSPreprocess.html"><a href="MSPreprocess.html#raw-data-conversion"><i class="fa fa-check"></i><b>4.1</b> Raw data conversion<span></span></a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="MSPreprocess.html"><a href="MSPreprocess.html#msconvert"><i class="fa fa-check"></i><b>4.1.1</b> MSConvert<span></span></a></li>
<li class="chapter" data-level="4.1.2" data-path="MSPreprocess.html"><a href="MSPreprocess.html#waters-mse"><i class="fa fa-check"></i><b>4.1.2</b> Waters MSe<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="MSPreprocess.html"><a href="MSPreprocess.html#peak-picking"><i class="fa fa-check"></i><b>4.2</b> Peak picking<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="MSPreprocess.html"><a href="MSPreprocess.html#open-tools-for-preprocessing"><i class="fa fa-check"></i><b>4.3</b> Open tools for preprocessing<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="MSPreprocess.html"><a href="MSPreprocess.html#openms-and-toppview"><i class="fa fa-check"></i><b>4.4</b> OpenMS and Toppview<span></span></a></li>
<li class="chapter" data-level="4.5" data-path="MSPreprocess.html"><a href="MSPreprocess.html#msnbase-and-xcms"><i class="fa fa-check"></i><b>4.5</b> MsnBase and XCMS<span></span></a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="MSPreprocess.html"><a href="MSPreprocess.html#xcms"><i class="fa fa-check"></i><b>4.5.1</b> XCMS<span></span></a></li>
<li class="chapter" data-level="4.5.2" data-path="MSPreprocess.html"><a href="MSPreprocess.html#camera"><i class="fa fa-check"></i><b>4.5.2</b> CAMERA<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="MSPreprocess.html"><a href="MSPreprocess.html#patroon"><i class="fa fa-check"></i><b>4.6</b> PatRoon<span></span></a></li>
<li class="chapter" data-level="4.7" data-path="MSPreprocess.html"><a href="MSPreprocess.html#ms-dial"><i class="fa fa-check"></i><b>4.7</b> MS-DIAL<span></span></a></li>
<li class="chapter" data-level="4.8" data-path="MSPreprocess.html"><a href="MSPreprocess.html#output-formats"><i class="fa fa-check"></i><b>4.8</b> Output formats<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="suspectScreening.html"><a href="suspectScreening.html"><i class="fa fa-check"></i><b>5</b> <strong>Suspect screening</strong><span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="suspectScreening.html"><a href="suspectScreening.html#lib2nist"><i class="fa fa-check"></i><b>5.1</b> LIB2NIST<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="suspectScreening.html"><a href="suspectScreening.html#listing-suspects"><i class="fa fa-check"></i><b>5.2</b> Listing suspects<span></span></a></li>
<li class="chapter" data-level="5.3" data-path="suspectScreening.html"><a href="suspectScreening.html#suspect-scoring"><i class="fa fa-check"></i><b>5.3</b> Suspect scoring<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="MassDefect.html"><a href="MassDefect.html"><i class="fa fa-check"></i><b>6</b> <strong>Mass defect plots</strong><span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="MassDefect.html"><a href="MassDefect.html#mdplotr"><i class="fa fa-check"></i><b>6.1</b> MDPlotR<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="MassDefect.html"><a href="MassDefect.html#findhalo"><i class="fa fa-check"></i><b>6.2</b> findhalo<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="RetentionTime.html"><a href="RetentionTime.html"><i class="fa fa-check"></i><b>7</b> <strong>Retention time index and prediction</strong><span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="RetentionTime.html"><a href="RetentionTime.html#lc"><i class="fa fa-check"></i><b>7.1</b> LC<span></span></a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="RetentionTime.html"><a href="RetentionTime.html#retip---retention-time-prediction-for-metabolomics"><i class="fa fa-check"></i><b>7.1.1</b> Retip - Retention Time prediction for Metabolomics<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="MolecularNetworks.html"><a href="MolecularNetworks.html"><i class="fa fa-check"></i><b>8</b> <strong>Molecular networks</strong><span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="MolecularNetworks.html"><a href="MolecularNetworks.html#metgem"><i class="fa fa-check"></i><b>8.1</b> MetGem<span></span></a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="MolecularNetworks.html"><a href="MolecularNetworks.html#metgem-parameters"><i class="fa fa-check"></i><b>8.1.1</b> Metgem parameters<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="MolecularNetworks.html"><a href="MolecularNetworks.html#gnps"><i class="fa fa-check"></i><b>8.2</b> GNPS<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Library.html"><a href="Library.html"><i class="fa fa-check"></i><b>9</b> <strong>Spectral libraries</strong><span></span></a>
<ul>
<li class="chapter" data-level="9.1" data-path="Library.html"><a href="Library.html#in-silico-fragmentation"><i class="fa fa-check"></i><b>9.1</b> IN SILICO FRAGMENTATION<span></span></a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="Library.html"><a href="Library.html#metfrag"><i class="fa fa-check"></i><b>9.1.1</b> Metfrag<span></span></a></li>
<li class="chapter" data-level="9.1.2" data-path="Library.html"><a href="Library.html#sirius-csi-fingerid"><i class="fa fa-check"></i><b>9.1.2</b> Sirius CSI FingerID<span></span></a></li>
<li class="chapter" data-level="9.1.3" data-path="Library.html"><a href="Library.html#cfm-id"><i class="fa fa-check"></i><b>9.1.3</b> CFM-ID<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="Library.html"><a href="Library.html#neims"><i class="fa fa-check"></i><b>9.2</b> NEIMS<span></span></a></li>
<li class="chapter" data-level="9.3" data-path="Library.html"><a href="Library.html#deepei"><i class="fa fa-check"></i><b>9.3</b> DeepEI<span></span></a></li>
<li class="chapter" data-level="9.4" data-path="Library.html"><a href="Library.html#qcxms"><i class="fa fa-check"></i><b>9.4</b> QCxMS<span></span></a></li>
<li class="chapter" data-level="9.5" data-path="Library.html"><a href="Library.html#library-search"><i class="fa fa-check"></i><b>9.5</b> LIBRARY SEARCH<span></span></a></li>
<li class="chapter" data-level="9.6" data-path="Library.html"><a href="Library.html#reading-mgf-files-in-r"><i class="fa fa-check"></i><b>9.6</b> Reading mgf files in R<span></span></a></li>
<li class="chapter" data-level="9.7" data-path="Library.html"><a href="Library.html#lib2nist-1"><i class="fa fa-check"></i><b>9.7</b> LIB2NIST<span></span></a></li>
<li class="chapter" data-level="9.8" data-path="Library.html"><a href="Library.html#mspepsearch"><i class="fa fa-check"></i><b>9.8</b> MSPepSearch<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="PostProcessing.html"><a href="PostProcessing.html"><i class="fa fa-check"></i><b>10</b> <strong>Data post-processing</strong><span></span></a>
<ul>
<li class="chapter" data-level="10.1" data-path="PostProcessing.html"><a href="PostProcessing.html#hierarchical-clustering"><i class="fa fa-check"></i><b>10.1</b> Hierarchical clustering<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ExampleDust.html"><a href="ExampleDust.html"><i class="fa fa-check"></i><b>11</b> Example workflow: indoor dust<span></span></a>
<ul>
<li class="chapter" data-level="11.1" data-path="ExampleDust.html"><a href="ExampleDust.html#gc-orbitrap-hrms-workflow"><i class="fa fa-check"></i><b>11.1</b> GC orbitrap HRMS workflow<span></span></a></li>
<li class="chapter" data-level="11.2" data-path="ExampleDust.html"><a href="ExampleDust.html#lc-hrms-using-waters-mse-dia-workflow"><i class="fa fa-check"></i><b>11.2</b> LC-HRMS using Waters MSe DIA workflow<span></span></a></li>
<li class="chapter" data-level="11.3" data-path="ExampleDust.html"><a href="ExampleDust.html#workflow-for-centroiding-of-raw-file-peak-picking-and-correlation-of-ms1-and-ms2"><i class="fa fa-check"></i><b>11.3</b> Workflow for centroiding of raw file, peak picking and correlation of MS1 and MS2<span></span></a></li>
<li class="chapter" data-level="11.4" data-path="ExampleDust.html"><a href="ExampleDust.html#first-convert-unifi-data-using-msconvert"><i class="fa fa-check"></i><b>11.4</b> First convert unifi data using MSConvert<span></span></a></li>
<li class="chapter" data-level="11.5" data-path="ExampleDust.html"><a href="ExampleDust.html#centroiding-raw-data-from-mzml-using-msnbase"><i class="fa fa-check"></i><b>11.5</b> Centroiding raw data from mzML using MSnbase<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ExamplePFAS.html"><a href="ExamplePFAS.html"><i class="fa fa-check"></i><b>12</b> Example workflow: PFASs<span></span></a></li>
<li class="chapter" data-level="13" data-path="DataConversion.html"><a href="DataConversion.html"><i class="fa fa-check"></i><b>13</b> Conversion of raw data from HRMS vendor format to open format<span></span></a>
<ul>
<li class="chapter" data-level="13.1" data-path="DataConversion.html"><a href="DataConversion.html#MSConvertGC"><i class="fa fa-check"></i><b>13.1</b> GC orbitrap HRMS: convert .raw data to .mzML using MSconvert<span></span></a></li>
<li class="chapter" data-level="13.2" data-path="DataConversion.html"><a href="DataConversion.html#MSConvertunifi"><i class="fa fa-check"></i><b>13.2</b> LC-HRMS: convert the raw data file from unifi to mzML using MSconvert<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="GClib.html"><a href="GClib.html"><i class="fa fa-check"></i><b>14</b> MTM HRMS Library: GC-HRMS<span></span></a>
<ul>
<li class="chapter" data-level="14.1" data-path="GClib.html"><a href="GClib.html#analyze-the-standards-using-hrms"><i class="fa fa-check"></i><b>14.1</b> Analyze the standards using HRMS<span></span></a></li>
<li class="chapter" data-level="14.2" data-path="GClib.html"><a href="GClib.html#convert-the-raw-data-file-from-gc-hrms-analysis-to-.mzml-using-msconvert-for-unifi-conversion-see-section-refmsconvertgc"><i class="fa fa-check"></i><b>14.2</b> Convert the raw data file from GC-HRMS analysis to .mzML using MSconvert (For unifi conversion, see section @ref(MSConvertGC)<span></span></a></li>
<li class="chapter" data-level="14.3" data-path="GClib.html"><a href="GClib.html#fill-in-the-standard-infosheet"><i class="fa fa-check"></i><b>14.3</b> Fill in the standard infosheet<span></span></a></li>
<li class="chapter" data-level="14.4" data-path="GClib.html"><a href="GClib.html#use-ms-dial-to-perform-spectral-deconvolution-and-generate-spectra-for-each-compound"><i class="fa fa-check"></i><b>14.4</b> Use MS-DIAL to perform spectral deconvolution and generate spectra for each compound<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="mtm-hrms-library-lc-hrms.html"><a href="mtm-hrms-library-lc-hrms.html"><i class="fa fa-check"></i><b>15</b> MTM HRMS Library: LC-HRMS<span></span></a>
<ul>
<li class="chapter" data-level="15.1" data-path="mtm-hrms-library-lc-hrms.html"><a href="mtm-hrms-library-lc-hrms.html#analyze-the-standards-using-hrms-1"><i class="fa fa-check"></i><b>15.1</b> Analyze the standards using HRMS<span></span></a></li>
<li class="chapter" data-level="15.2" data-path="mtm-hrms-library-lc-hrms.html"><a href="mtm-hrms-library-lc-hrms.html#convert-the-raw-data-file-from-lc-hrms-in-unifi-to-mzml-using-msconvert"><i class="fa fa-check"></i><b>15.2</b> Convert the raw data file from LC-HRMS in unifi to mzML using MSconvert<span></span></a></li>
<li class="chapter" data-level="15.3" data-path="mtm-hrms-library-lc-hrms.html"><a href="mtm-hrms-library-lc-hrms.html#fill-in-the-standard-infosheet-1"><i class="fa fa-check"></i><b>15.3</b> Fill in the standard infosheet<span></span></a></li>
<li class="chapter" data-level="15.4" data-path="mtm-hrms-library-lc-hrms.html"><a href="mtm-hrms-library-lc-hrms.html#use-ms-dial-to-perform-spectral-deconvolution-and-generate-spectra-for-each-compound-1"><i class="fa fa-check"></i><b>15.4</b> Use MS-DIAL to perform spectral deconvolution and generate spectra for each compound<span></span></a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="GCMSDIAL.html"><a href="GCMSDIAL.html"><i class="fa fa-check"></i><b>16</b> GC-HRMS raw data preprocessing with MS-DIAL<span></span></a>
<ul>
<li class="chapter" data-level="16.1" data-path="GCMSDIAL.html"><a href="GCMSDIAL.html#post-processing"><i class="fa fa-check"></i><b>16.1</b> Post processing<span></span></a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="GCMSDIAL.html"><a href="GCMSDIAL.html#convert-riken-msp-to-nist-to-be-compatible-with-mspepsearch"><i class="fa fa-check"></i><b>16.1.1</b> Convert RIKEN msp to NIST to be compatible with MSPepSearch<span></span></a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="GCMSDIAL.html"><a href="GCMSDIAL.html#further-explanation-for-some-terminologies-apart-from-the-tutorial-httpsmtbinfo-team.github.iomtbinfo.github.ioms-dialtutorial"><i class="fa fa-check"></i><b>16.2</b> Further explanation for some terminologies apart from the tutorial (<span>https://mtbinfo-team.github.io/mtbinfo.github.io/MS-DIAL/tutorial</span>)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="LCHRMSMSe.html"><a href="LCHRMSMSe.html"><i class="fa fa-check"></i><b>17</b> LC-HRMS MSe raw data preprocessing with MS-DIAL<span></span></a>
<ul>
<li class="chapter" data-level="17.1" data-path="LCHRMSMSe.html"><a href="LCHRMSMSe.html#some-recommended-values-for-g2-xs-qtof"><i class="fa fa-check"></i><b>17.1</b> Some recommended values for G2 XS qtof:<span></span></a></li>
<li class="chapter" data-level="17.2" data-path="LCHRMSMSe.html"><a href="LCHRMSMSe.html#post-processing-1"><i class="fa fa-check"></i><b>17.2</b> Post processing<span></span></a></li>
<li class="chapter" data-level="17.3" data-path="LCHRMSMSe.html"><a href="LCHRMSMSe.html#further-explanation-for-some-terminologies-apart-from-the-tutorial-httpsmtbinfo-team.github.iomtbinfo.github.ioms-dialtutorial-1"><i class="fa fa-check"></i><b>17.3</b> Further explanation for some terminologies apart from the tutorial (<span>https://mtbinfo-team.github.io/mtbinfo.github.io/MS-DIAL/tutorial</span>)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="GCOrbitrapHandbook.html"><a href="GCOrbitrapHandbook.html"><i class="fa fa-check"></i><b>18</b> A handbook on GC Q Exactive orbitrap use<span></span></a>
<ul>
<li class="chapter" data-level="18.1" data-path="GCOrbitrapHandbook.html"><a href="GCOrbitrapHandbook.html#acquisition-parameters"><i class="fa fa-check"></i><b>18.1</b> Acquisition parameters<span></span></a></li>
<li class="chapter" data-level="18.2" data-path="GCOrbitrapHandbook.html"><a href="GCOrbitrapHandbook.html#chemical-ionization"><i class="fa fa-check"></i><b>18.2</b> Chemical ionization<span></span></a></li>
<li class="chapter" data-level="18.3" data-path="GCOrbitrapHandbook.html"><a href="GCOrbitrapHandbook.html#terminologies-1"><i class="fa fa-check"></i><b>18.3</b> Terminologies<span></span></a></li>
<li class="chapter" data-level="18.4" data-path="GCOrbitrapHandbook.html"><a href="GCOrbitrapHandbook.html#cleaning-source"><i class="fa fa-check"></i><b>18.4</b> Cleaning source<span></span></a></li>
<li class="chapter" data-level="18.5" data-path="GCOrbitrapHandbook.html"><a href="GCOrbitrapHandbook.html#performance-mixture"><i class="fa fa-check"></i><b>18.5</b> Performance mixture<span></span></a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="reproducible-research-using-docker-containers-and-similar-tools.html"><a href="reproducible-research-using-docker-containers-and-similar-tools.html"><i class="fa fa-check"></i><b>19</b> Reproducible research using Docker containers and similar tools<span></span></a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Handbook of comprehensive suspect and nontarget workflows in environmental analysis using GC and LC-HRMS</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="MSPreprocess" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> <strong>Pre-processing HRMS data</strong><a href="MSPreprocess.html#MSPreprocess" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><br><br></p>
<div id="raw-data-conversion" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Raw data conversion<a href="MSPreprocess.html#raw-data-conversion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="msconvert" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> MSConvert<a href="MSPreprocess.html#msconvert" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<table>
<thead>
<tr>
<th style="text-align:left;">
What
</th>
<th style="text-align:left;">
Code
</th>
<th style="text-align:left;">
Comment
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Website
</td>
<td style="text-align:left;">
<a href="https://proteowizard.sourceforge.io/tools/msconvert.html" class="uri">https://proteowizard.sourceforge.io/tools/msconvert.html</a>
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Docker: Pull from docker repo
</td>
<td style="text-align:left;">
docker pull chambm/pwiz-skyline-i-agree-to-the-vendor-licenses
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Docker: Help
</td>
<td style="text-align:left;">
docker run -it –rm chambm/pwiz-skyline-i-agree-to-the-vendor-licenses wine msconvert –help
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Docker: convert a file
</td>
<td style="text-align:left;">
docker run -it –rm -e WINEDEBUG=-all -v /your/<a href="data:/data" class="uri">data:/data</a> chambm/pwiz-skyline-i-agree-to-the-vendor-licenses wine msconvert /data/file.raw
</td>
<td style="text-align:left;">
docker run -it –rm -e WINEDEBUG=-all -v /home/ORUNET.ORU.SE/twg/Windows_home/Raw_Data/Guo_Feng/100.RAW:/data chambm/pwiz-skyline-i-agree-to-the-vendor-licenses wine msconvert /data/100.raw
</td>
</tr>
<tr>
<td style="text-align:left;">
Docker: convert all the files in a folder
</td>
<td style="text-align:left;">
docker run -it –rm -e WINEDEBUG=-all -v /your/data/path/*.RAW:/data chambm/pwiz-skyline-i-agree-to-the-vendor-licenses wine msconvert /data/
</td>
<td style="text-align:left;">
docker run -it –rm -e WINEDEBUG=-all -v ~/Windows_home/Raw_Data/Kallinge/New_analysis_20200414/test/*.mzML:/data chambm/pwiz-skyline-i-agree-to-the-vendor-licenses wine msconvert /data/
</td>
</tr>
<tr>
<td style="text-align:left;">
use vendor centroiding for msLevels in [1,2]
</td>
<td style="text-align:left;">
msconvert data.RAW –filter "peakPicking true [1,2]"
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Docker: use vendor centroiding for msLevels in [1,2]
</td>
<td style="text-align:left;">
docker run -it –rm -e WINEDEBUG=-all -v /home/ORUNET.ORU.SE/twg/Raw_data/Kallinge/New_analysis_20200414/centroid/:/data chambm/pwiz-skyline-i-agree-to-the-vendor-licenses wine msconvert /data/*.mzML –filter “peakPicking true [1,2]” –mzXML
</td>
<td style="text-align:left;">
Works now but need to copy files to the tla-01/02 server to be ok. From Yu Miao: The only issue is that if you convert mzML to another mzML, you will get an error about “Output filepath is the same as input filepath.” So I added ‘–mzXML’ to give another name. The only issue is that if you convert mzML to another mzML, you will get an error about “Output filepath is the same as input filepath.” So I added ‘–mzXML’ to give another name. This command contain two parts. The first part mapping your local mzML folder to the docker image’s ‘data’ folder. The second part is convert mzML files in this folder into new files.
</td>
</tr>
</tbody>
</table>
</div>
<div id="waters-mse" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Waters MSe<a href="MSPreprocess.html#waters-mse" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://ccms-ucsd.github.io/GNPSDocumentation/fileconversion_waters/" class="uri">https://ccms-ucsd.github.io/GNPSDocumentation/fileconversion_waters/</a></p>
</div>
</div>
<div id="peak-picking" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Peak picking<a href="MSPreprocess.html#peak-picking" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<br>
<div class="figure">
<img src="images/isotopic_pattern_PFOS.PNG" alt="PFOS isotopic patterns" width="724" />
<p class="caption">
(#fig:PFOS isotopes)PFOS isotopic patterns
</p>
</div>
<p><br></p>
<div class="figure">
<img src="images/mass_traces_PFOS_IS_RS.PNG" alt="Mass traces of PFOS and labelled standards" width="631" />
<p class="caption">
(#fig:peak picking)Mass traces of PFOS and labelled standards
</p>
</div>
<p><br><br>
## Alignment</p>
<p><br><br>
## Componentization</p>
<p><br><br>
## Proprietary and standardized MS data format
<br>
See: <a href="https://en.wikipedia.org/wiki/Mass_spectrometry_data_format" class="uri">https://en.wikipedia.org/wiki/Mass_spectrometry_data_format</a></p>
<p><br><br></p>
</div>
<div id="open-tools-for-preprocessing" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Open tools for preprocessing<a href="MSPreprocess.html#open-tools-for-preprocessing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="openms-and-toppview" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> OpenMS and Toppview<a href="MSPreprocess.html#openms-and-toppview" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>xx</p>
<p><br>
<a href="https://www.youtube.com/watch?v=GuK1daIc6vo&amp;list=PL2u38g_AG4MH7yCMF06N2VW7eZOJcglh7&amp;index=5" class="uri">https://www.youtube.com/watch?v=GuK1daIc6vo&amp;list=PL2u38g_AG4MH7yCMF06N2VW7eZOJcglh7&amp;index=5</a></p>
<p><br><br>
## MSConvert
xx
<br><br></p>
</div>
<div id="msnbase-and-xcms" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> MsnBase and XCMS<a href="MSPreprocess.html#msnbase-and-xcms" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>xx
<br></p>
<div id="xcms" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> XCMS<a href="MSPreprocess.html#xcms" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Check: A scalable workflow to characterize the human exposome, SI-11, <a href="https://www.nature.com/articles/s41467-021-25840-9#MOESM14" class="uri">https://www.nature.com/articles/s41467-021-25840-9#MOESM14</a></p>
<p>IPO optimization</p>
</div>
<div id="camera" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> CAMERA<a href="MSPreprocess.html#camera" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="http://www.metabolomics-forum.com/index.php?topic=278.0" class="uri">http://www.metabolomics-forum.com/index.php?topic=278.0</a>
calcCiS: Calculate correlation inside samples
That means correlation across the peak = is it really coeluting or not?
It is correlation inside the sample; not inside a sample group. This means that camera goes back to the raw data and compares extracted ion chromatograms.
The illutration in Carsten’s paper show this: <a href="http://pubs.acs.org/doi/abs/10.1021/ac202450g" class="uri">http://pubs.acs.org/doi/abs/10.1021/ac202450g</a>
This will fail if compounds are perfectly coeluting.</p>
<p>calcCaS: Calculate correlation accross samples
They are correlated if high intensity of feature A means high intensity of feature B. The study design or sample groups are not used for this information.
Look at these plots. Each dot is a sample.</p>
</div>
</div>
<div id="patroon" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> PatRoon<a href="MSPreprocess.html#patroon" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>xx
<br><br></p>
<p><a href="https://www.researchsquare.com/article/rs-36675/v1" class="uri">https://www.researchsquare.com/article/rs-36675/v1</a>
<br>
<a href="https://rickhelmus.github.io/patRoon/articles/tutorial.html" class="uri">https://rickhelmus.github.io/patRoon/articles/tutorial.html</a>
<br></p>
<p>OpenMS performs peak picking and isotope grouping in one step (any idea how to turn off this?), while XCMS does not perform this step here.
From Rick: For OpenMS: you can use a trick for this by setting localMZRange=0, this way OpenMS won’t be able to look for isotopes. Note that its detection was more developed for ‘natural compounds’ (eg proteomics, metabolomics) in mind, and that it isn’t really good in grouping halogenated peaks anyway.</p>
<p>PatRoon Docker:<br />
In linux, run:<br />
docker run –rm -p 8787:8787 -u 0 -e PASSWORD=yourpasswordhere -v /home/ORUNET.ORU.SE/twg/Raw_<a href="data:/home/rstudio/Raw_data" class="uri">data:/home/rstudio/Raw_data</a> patroonorg/patroonrs /init</p>
</div>
<div id="ms-dial" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> MS-DIAL<a href="MSPreprocess.html#ms-dial" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>MS2Dec: <br>
Sigma window value: 0.1 - 1.0. Smaller value will avoid clustering of peaks that are far from each other (false positive grouping).<br />
In GC-HRMS, try 0.8 to separate and deconvolute very closely coeluting peak in GC (+-1). These parameters should be tested with e.g. QC samples with known compounds to get best deconvolution parameter for your samples.
<br>
MS/MS abundance cut off: increase to remove background noise</p>
<p><br><br></p>
</div>
<div id="output-formats" class="section level2 hasAnchor" number="4.8">
<h2><span class="header-section-number">4.8</span> Output formats<a href="MSPreprocess.html#output-formats" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><br>
- MSnExp and XCMSnExp <br>
- MSP <br>
- MFG <br>
- CSV (for both output data or metadata) <br></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="SamplePretreatment.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="suspectScreening.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown/edit/master/inst/examples/04-MS_preprocess.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SSANTA.pdf", "SSANTA.epub", "SSANTA.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
